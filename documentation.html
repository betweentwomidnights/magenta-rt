<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>magenta-rt backend</title>
  <style>
    body { 
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
      max-width: 900px; 
      margin: 48px auto; 
      padding: 0 24px; 
      color: #111; 
      line-height: 1.6;
      background: #fafafa;
    }
    .header { 
      text-align: center; 
      margin-bottom: 48px;
      background: white;
      padding: 32px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .badge { 
      display: inline-block; 
      background: #ff6b35; 
      color: white; 
      padding: 4px 12px; 
      border-radius: 16px; 
      font-size: 0.85em; 
      font-weight: 500;
      margin-left: 8px;
    }
    .section {
      background: white;
      padding: 32px;
      margin: 24px 0;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .btn {
      display: inline-block;
      background: #0969da;
      color: white;
      padding: 12px 24px;
      border-radius: 8px;
      text-decoration: none;
      font-weight: 500;
      margin: 8px;
    }
    .btn:hover {
      background: #0550ae;
    }
    .btn-secondary {
      background: #656d76;
    }
    .btn-secondary:hover {
      background: #424a53;
    }
    .demo-video {
      text-align: center;
      margin: 32px 0;
    }
    .demo-video video {
      width: 100%;
      max-width: 540px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    .info { 
      background: #dbeafe; 
      border: 1px solid #3b82f6; 
      border-radius: 8px; 
      padding: 16px; 
      margin: 16px 0;
    }
    a { color: #0969da; text-decoration: none; }
    a:hover { text-decoration: underline; }
    .muted { color: #656d76; font-size: 0.9em; }
    ul { line-height: 1.8; }
    code {
      background: #f6f8fa;
      border: 1px solid #eaecef;
      border-radius: 4px;
      padding: 2px 6px;
      font-family: 'SF Mono', Monaco, monospace;
      font-size: 0.9em;
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>magenta-rt backend</h1>
    <p class="muted">
      <strong>local backend for gary4juce</strong><br>
      also includes real-time streaming and continuous jamming endpoints
    </p>
    <span class="badge">running locally</span>
  </div>

  <div class="section">
    <h2>what you're looking at</h2>
    <p>
      this is a docker container running google's <a href="https://github.com/magenta/magenta-realtime" target="_blank">magenta-realtime</a> model. 
      primarily designed as the "darius" backend for <a href="https://thepatch.gumroad.com/l/gary4juce" target="_blank">gary4juce</a>, 
      but includes additional endpoints for real-time streaming and continuous generation.
    </p>
    
    <div class="info">
      <strong>backend URL:</strong> <code>http://localhost:7860</code><br>
      enter this in gary4juce's darius settings to start generating music continuations from your DAW.
    </div>
  </div>

  <div class="section">
    <h2>try the web tester</h2>
    <p>
      experiment with real-time music generation in your browser. this interface lets you generate music on the fly, 
      adjust parameters live, and switch between different models and checkpoints.
    </p>
    <p style="text-align: center; margin-top: 24px;">
      <a class="btn" href="/tester" target="_blank">open real-time web tester</a>
    </p>
  </div>

  <div class="demo-video">
    <h3>untitled jamming app demo</h3>
    <video controls preload="metadata" playsinline>
      <source src="./lil_demo_540p.mp4" type="video/mp4">
      your browser does not support the video tag.
    </video>
    <p class="muted">the <code>/jam/*</code> endpoints power this iOS app (currently in TestFlight)</p>
  </div>

  <div class="section">
    <h2>available endpoints</h2>
    
    <h3>one-shot generation (gary4juce)</h3>
    <ul>
      <li><code>POST /generate</code> - generate 4/8/16 bars with input audio</li>
      <li><code>POST /generate_style</code> - experimental style-only generation</li>
      <li><code>GET /progress</code> - poll generation progress</li>
    </ul>

    <h3>continuous jamming (iOS/mobile apps)</h3>
    <ul>
      <li><code>POST /jam/start</code> - start continuous generation session</li>
      <li><code>GET /jam/next</code> - get next audio chunk</li>
      <li><code>POST /jam/consume</code> - mark chunk as consumed</li>
      <li><code>POST /jam/update</code> - update parameters mid-session</li>
      <li><code>POST /jam/stop</code> - end session</li>
    </ul>

    <h3>websocket streaming (web tester)</h3>
    <ul>
      <li><code>WS /ws/jam</code> - real-time streaming interface</li>
    </ul>

    <h3>model management</h3>
    <ul>
      <li><code>POST /model/select</code> - switch between models and finetunes</li>
      <li><code>GET /model/status</code> - check current configuration</li>
      <li><code>GET /model/checkpoints</code> - list available checkpoints</li>
    </ul>

    <h3>utilities</h3>
    <ul>
      <li><code>GET /health</code> - check system status</li>
      <li><code>GET /docs</code> - auto-generated API docs</li>
      <li><code>GET /ping</code> - simple connectivity test</li>
    </ul>
  </div>

  <div class="section">
    <h2>using custom finetunes</h2>
    <p>
      you can train your own magenta-rt models and load them through the <code>/model/select</code> endpoint. 
      for detailed instructions on training, packaging, and uploading finetunes, see the 
      <a href="https://github.com/betweentwomidnights/magenta-rt-backend" target="_blank">github repo README</a>.
    </p>
    <p>
      example finetune repo: <a href="https://huggingface.co/thepatch/magenta-ft" target="_blank">thepatch/magenta-ft</a>
    </p>
  </div>

  <div class="section">
    <h2>quick links</h2>
    <p style="text-align: center;">
      <a class="btn" href="/tester" target="_blank">web tester</a>
      <a class="btn btn-secondary" href="/docs" target="_blank">api docs</a>
      <a class="btn btn-secondary" href="https://github.com/betweentwomidnights/magenta-rt-backend" target="_blank">github repo</a>
      <a class="btn btn-secondary" href="https://thepatch.gumroad.com/l/gary4juce" target="_blank">get gary4juce</a>
    </p>
  </div>

  <div class="section">
    <h2>support & community</h2>
    <p>
      having trouble or want to connect with other users?
    </p>
    <ul>
      <li>email: <a href="mailto:kev@thecollabagepatch.com">kev@thecollabagepatch.com</a></li>
      <li>discord: <a href="https://discord.gg/T8HVqwQw6T" target="_blank">https://discord.gg/T8HVqwQw6T</a></li>
      <li>github: <a href="https://github.com/betweentwomidnights/magenta-rt-backend" target="_blank">report issues</a></li>
    </ul>
  </div>

  <div class="section" style="text-align: center; background: #f6f8fa;">
    <p class="muted">
      built on google's <a href="https://github.com/magenta/magenta-realtime" target="_blank">magenta-realtime</a> (Apache 2.0 + CC-BY 4.0)<br>
      developed by <a href="https://thecollabagepatch.com" target="_blank">collabagepatch</a>
    </p>
  </div>
</body>
</html>